<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculator</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="case">
        <div class="screen"></div>
            <div class="button-container">
                <button class="clear">CLEAR</button>
                <button class="del">DELETE</button>
                <button id="num" data-key="7">7</button>
                <button id="num" data-key="8">8</button>
                <button id="num" data-key="9">9</button>
                <button id="op" data-key="/">\</button>
                <button id="num" data-key="4">4</button>
                <button id="num" data-key="5">5</button>
                <button id="num" data-key="6">6</button>
                <button id="op" data-key="*">x</button>
                <button id="num" data-key="1">1</button>
                <button id="num" data-key="2">2</button>
                <button id="num" data-key="3">3</button>
                <button id="op" data-key="-">-</button>
                <button id="op" data-key=".">.</button>
                <button id="num" data-key="0">0</button>
                <button id="op" data-key="=">=</button>
                <button id="op" data-key="+">+</button>
        </div>
    </div>



    <script>

    let fullNum = [];
    let partNum = [];
    let currentOperator;
    let lastOperator;
    let equalsPressed = false;
    let operatorActive = false;
        
        //screen
        const screen = document.querySelector('.screen');
        //clear and del button events
        const clearBtn = document.querySelector('.clear');
              clearBtn.addEventListener('click', () => {
                fullNum = [];
                partNum = [];
                const screenContentArr = screen.textContent.split('');
                screenContentArr.pop();
                console.log(screenContentArr);
                //see the new values of fullNum
                const operatorFound = (element) => 
                element == '+' || element == '-' || element == '*' || element == '/';
                if(operatorFound != undefined){
                    for (let i = 0; i < screenContentArr.findIndex(operatorFound); i++){
                    fullNum.push(screenContentArr[i]);
                }
                }
                screen.textContent = screen.textContent.slice(0, screen.textContent.length - 1);
            });
        const delBtn = document.querySelector('.del');
              delBtn.addEventListener('click', () => {
                fullNum = [];
                partNum = [];
                lastOperator = [];
                equalsPressed = false;
                screen.textContent = '';
              });
        
        //numbers and number events
        const numButtons = document.querySelectorAll('#num'); 
              numButtons.forEach(a => a.addEventListener('click', () => {screen.textContent += a.dataset.key; partNum.push(a.dataset.key)}));
        //operators and operator events
        const operatorButtons = document.querySelectorAll('#op'); 
              operatorButtons.forEach(a => a.addEventListener('click', () => {
                    if(a.dataset.key != '=' && a.dataset.key != '.'){ // operators
                        equalsPressed = false;
                        currentOperator = a.dataset.key;
                        createEquation();
                        operatorActive = true;
                    }
                    else if (a.dataset.key == '=' && !equalsPressed){ // equals
                        equalsPressed = true;
                        createEquation();
                    }
                    else if (a.dataset.key == '.'){
                        if(!partNum.includes('.') && partNum[0] != undefined){ // deciaml
                            partNum.push('.'); screen.textContent += '.';
                        }
                    }
              }));


    function createEquation(){
        if(currentOperator == undefined) return;
        if(partNum[0] !== undefined)fullNum.push(partNum.join(''));
        if(fullNum[0] !== undefined && !operatorActive){
            screen.textContent += currentOperator;
            lastOperator = currentOperator;
        }
        partNum = [];

        if(fullNum[1] !== undefined){
            let answer = operate(lastOperator, fullNum[0], fullNum[1]);
            fullNum = [];
            fullNum.push(answer);
            if(equalsPressed){
                screen.textContent = '=' + answer;
                lastOperator = [];
            }else if (!equalsPressed){
                screen.textContent = '=' + answer + currentOperator;
                lastOperator = currentOperator;
            }
            operatorActive = false;
        }
        else return;
    }

    function operate(operator, num1, num2){
        if(fullNum[1] == undefined) return;
             if(operator == '+'){return +num1 + +num2}
        else if(operator == '-'){return +num1 - +num2}
        else if(operator == '*'){return +num1 * +num2}
        else if(operator == '/'){return +num1 / +num2}
    }
    </script>

</body>
</html>